.ttestHypothesisText <- function(jaspResults, dataset, options, ready, type) {
    if (!is.null(jaspResults[["hypothesisText"]]))
        return()
    if (!options$autoReport)
        return()
    optionsList <- .ttestOptionsList(options, type)
    groups    <- options$group
    levels <- base::levels(dataset[[ groups ]])
    
    mtr <- jaspResults[["mainTableResults"]]$object
    ttest <- jaspResults[["mainTableTtest"]]$object
    
    column_names <- c()
    for (column in 1:(ncol(mtr))){
        name <- ttest$getColumnName(column)
        column_names <- append(column_names, as.character(name))
    }
    # Order of items: df, p, Location Parameter, Effect Size, CI LocPar Lo, 
    # CI LocPar Up, CI Eff Lo, CI Eff Up, SE Eff, SE Diff, Statistic, VS-MPR
    
    mtr_rounded <- lapply(mtr, round, digits = 3)
    significant <- ifelse(mtr_rounded[match("p", column_names)] > 0.05, "not", "")
    test_type <- c("standard t-", "Welch t-", "Mann-Whitney U")
    hypothesisTitle <- createJaspHtml(
        text = gettextf("<h2>5. Hypothesis Testing: Is The Effect Absent?</h2>"))
    
    jaspResults[["hypothesisTitle"]] <- hypothesisTitle
    
    if (optionsList$wantsStudents) {
        hypothesisStudent <- createJaspHtml(
            text = gettextf("
        For the %7$stest, the group difference is %3$s
        statistically significant at the .05 level: p=%4$s, t(%5$s) = %6$s. 
        We may %3$s reject the null-hypothesis of no population 
        difference between the groups. [NB. this needs to be adjusted for a 
        one-sided test] The Vovk-Sellke maximum p-Ratio of 3.6162 indicates the 
        maximum possible odds in favor of H1 over H0, which is not compelling and 
        urges caution. [only include for odds lower than 10]<br>",
                            levels[1], levels[2],
                            significant,  mtr_rounded[match("p", column_names)], 
                            mtr_rounded[match("df", column_names)], 
                            mtr_rounded[match("test", column_names)], "standard t-"))
        
        jaspResults[["hypothesisStudent"]] <- hypothesisStudent
    } 
    
    if (optionsList$wantsWilcox) {
        hypothesisWilcox <- createJaspHtml(
            text = gettextf("
        For the %7$stest, the group difference is %3$s
        statistically significant at the .05 level: p=%4$s, t(%5$s) = %6$s. 
        We may %3$s reject the null-hypothesis of no population 
        difference between the groups. [NB. this needs to be adjusted for a 
        one-sided test] The Vovk-Sellke maximum p-Ratio of 3.6162 indicates the 
        maximum possible odds in favor of H1 over H0, which is not compelling and 
        urges caution. [only include for odds lower than 10]<br>",
                            levels[1], levels[2],
                            significant,  mtr_rounded[match("p", column_names)], 
                            mtr_rounded[match("df", column_names)], 
                            mtr_rounded[match("test", column_names)], "Mann-Whitney U"))

        jaspResults[["hypothesisText"]] <- hypothesisWilcox
    } 
    
    if (optionsList$wantsWelchs) {
        hypothesisWelch <- createJaspHtml(
            text = gettextf("
        For the %7$stest, the group difference is %3$s
        statistically significant at the .05 level: p=%4$s, t(%5$s) = %6$s. 
        We may %3$s reject the null-hypothesis of no population 
        difference between the groups. [NB. this needs to be adjusted for a 
        one-sided test] The Vovk-Sellke maximum p-Ratio of 3.6162 indicates the 
        maximum possible odds in favor of H1 over H0, which is not compelling and 
        urges caution. [only include for odds lower than 10]<br>",
                            levels[1], levels[2],
                            significant,  mtr_rounded[match("p", column_names)], 
                            mtr_rounded[match("df", column_names)], 
                            mtr_rounded[match("test", column_names)], "Welch t-"))
        
        jaspResults[["hypothesisWelch"]] <- hypothesisWelch
    }
        
    hypothesisText <- createJaspHtml(
        text = gettextf("
        For the %11$stest, the group difference is %3$s
        statistically significant at the .05 level: p=%4$s, t(%5$s) = %6$s. 
        We may %3$s reject the null-hypothesis of no population 
        difference between the groups. [NB. this needs to be adjusted for a 
        one-sided test] The Vovk-Sellke maximum p-Ratio of 3.6162 indicates the 
        maximum possible odds in favor of H1 over H0, which is not compelling and 
        urges caution. [only include for odds lower than 10]<br>
        For the %11$s test, the group difference is %3$s statistically 
        significant at the .05 level: p=.0264, t(37.8554) = -2.3109. We may reject 
        [fork: may not reject] the null-hypothesis of no population difference 
        between the groups. [NB. this needs to be adjusted for a one-sided test]<br>
        For the %11$s test, the group difference is %3$s 
        statistically significant at the .05 level: p=.0127, rank biserial 
        correlation = -0.4410. We may reject [fork: may not reject] the 
        null-hypothesis of no population difference between the groups. 
        [NB. this needs to be adjusted for a one-sided test]<br>
         <br> %7$s <br>%8$s <br>%9$s
        <br>%10$s", 
                        levels[1], levels[2],
        significant,  mtr_rounded[match("p", column_names)], 
        mtr_rounded[match("df", column_names)], 
        mtr_rounded[match("test", column_names)], 
        paste(mtr_rounded, collapse = " "), 
        paste(column_names, collapse = " "), 
        paste(optionsList, collapse = ' '), paste(names(optionsList), collapse = " "), 
        "standard t-"
        ))
    
    hypothesisPval <- createJaspHtml(
        text = gettextf("The p-value does not quantify evidence for the null 
        hypothesis versus the alternative hypothesis; the p-value also cannot be 
        taken to mean that the null hypothesis is either likely or unlikely to 
        hold, or that the data are more or less likely to occur under the null 
        hypothesis than under the alternative hypothesis. In order to obtain this 
        information a Bayesian analysis would be needed."))
    
    # jaspResults[["hypothesisText"]] <- hypothesisText
    jaspResults[["hypothesisPval"]] <- hypothesisPval
}